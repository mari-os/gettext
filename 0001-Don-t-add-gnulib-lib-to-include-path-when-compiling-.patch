From 47a38a721d186ba6ae2a8dd6b23ae0b1ad6249ee Mon Sep 17 00:00:00 2001
From: Daiki Ueno <ueno@gnu.org>
Date: Fri, 30 Aug 2013 17:23:50 +0900
Subject: [PATCH 1/8] Don't add 'gnulib-lib' to include path when compiling
 libgettextpo tests.

---
 gettext-tools/tests/ChangeLog   | 7 +++++++
 gettext-tools/tests/Makefile.am | 7 ++++++-
 2 files changed, 13 insertions(+), 1 deletion(-)

diff --git a/gettext-tools/tests/ChangeLog b/gettext-tools/tests/ChangeLog
index 8e8b4dc..fff1ace 100644
--- a/gettext-tools/tests/ChangeLog
+++ b/gettext-tools/tests/ChangeLog
@@ -1,3 +1,10 @@
+2013-08-30  Daiki Ueno  <ueno@gnu.org>
+
+	* Makefile.am (gettextpo_1_prg_CPPFLAGS): Don't add 'gnulib-lib'
+	to the include path.
+	Reported by Perry Smith in
+	<https://lists.gnu.org/archive/html/bug-gettext/2013-08/msg00053.html>.
+
 2013-08-12  Daiki Ueno  <ueno@gnu.org>
 
 	* xgettext-glade-7: Add a test for multi-line extracted comments.
diff --git a/gettext-tools/tests/Makefile.am b/gettext-tools/tests/Makefile.am
index 37e7bbc..0293c4c 100644
--- a/gettext-tools/tests/Makefile.am
+++ b/gettext-tools/tests/Makefile.am
@@ -253,7 +253,12 @@ fc4_LDADD = ../gnulib-lib/libgettextlib.la $(LDADD)
 fc5_SOURCES = format-c-5-prg.c
 fc5_LDADD = ../gnulib-lib/libgettextlib.la $(LDADD)
 gettextpo_1_prg_SOURCES = gettextpo-1-prg.c
-gettextpo_1_prg_CPPFLAGS = -I../libgettextpo -I$(top_srcdir)/libgettextpo $(AM_CPPFLAGS)
+# Don't add 'gnulib-lib' to the include path here.  Some header files
+# there may interfere with the ones in 'libgettextpo'.
+gettextpo_1_prg_CPPFLAGS = \
+  -I.. \
+  -I../libgettextpo -I$(top_srcdir)/libgettextpo \
+  -I../intl
 # Don't add more libraries here. This test must check whether libgettextpo is
 # self contained.
 gettextpo_1_prg_LDADD = ../libgettextpo/libgettextpo.la $(LDADD)
-- 
1.8.3.4

